## 错排问题

$n$ 封信放入 $n$ 个信箱，每封信都不在属于自己的信箱内，存在多少种放置可能？

错排 (Derangement) , 因此错排公式中使用 $D(n)$ 示 $n$ 个元素的错排。

显然：
$D(1)=0$
$D(2)=1$

现在我们来推导递推式：

假设我们先把 $a$ 放在任意一个位置，显然有 $n-1$ 种情况。
假设 $a$ 占据的位置为 $b$，我们来放 $b$:

1. **$b$ 一定会放到 $a$**

    这样的话相当于 $a,b$ 交换，不会影响到其他的位置，那么就是剩下 $n-2$ 封信做错排，结果为 $D(n-2)$ 

2. **$b$ 一定不会放到 $a$**

    这个时候，我们可以认为 " 位置 $a$ 是 $b$ 原本的位置 ", 假设 $b$ 一开始就是放在 $a$ 的，现在我要让 $b$ 一定不在 $a$ 的位置。我们只要将 $b$ 错排即可，也就是将除 $a$ 之外所有的元素错排，结果为 $D(n-1)$

递推式为：$D(n) = (n-1)\cdot (D(n-2)+D(n-1))$